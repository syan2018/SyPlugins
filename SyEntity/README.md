# SyEntity - 通用实体框架

## 1. 系统概述

SyEntity框架是一个基于组件的游戏对象及其状态管理系统，旨在提供非侵入式、灵活且可扩展的方式来管理游戏实体及其状态。本框架通过组件化设计使得通用游戏逻辑可以轻松集成到任何现有的Unreal项目中，无需修改现有Actor结构。

## 2. 核心设计理念

### 2.1 组件化管理
- Entity作为一个组件存在，负责管理和协调其他功能组件
- 任何Actor可通过简单添加EntityComponent获得框架能力
- 使用组件接口实现功能，而非继承关系，实现松耦合设计

### 2.2 双向状态管理
- 每个Entity具备独立管理自身状态的能力
- 同时支持与全局StateManager进行状态同步
- 不同Entity类型可拥有各自特定的状态集合
- 状态定义与管理与实体逻辑分离，支持数据驱动配置

## 3. 模块架构

### 3.1 核心组件

#### SyEntityComponent
- **角色**：框架核心，负责组件管理与协调
- **职责**：
  - 提供唯一实体标识
  - 管理和索引附属功能组件
  - 实现组件间通信机制
  - 生命周期管理

#### SyStateComponent
- **角色**：实体状态管理组件
- **职责**：
  - 维护本地状态集合
  - 支持与全局StateManager同步
  - 提供状态变更通知机制
  - 加载和应用类型特定的状态配置

#### 功能扩展组件
- **交互组件**：处理实体的最基本Gameplay交互逻辑，如靠近、交互标识等
- **消息组件**：SyCore实现，管理消息发送与接收
- **标识组件**：SyCore实现，确保实体唯一性和可查找性

### 3.2 支持系统

#### SyStateManager子系统
- **角色**：全局状态管理与同步
- **职责**：
  - 集中管理实体状态
  - 提供状态查询接口
  - 实现状态变更广播
  - 支持通过修饰器变更状态
  - 支持状态持久化

#### SyEntityRegistry
- **角色**：实体注册表
- **职责**：
  - 维护活动实体索引
  - 提供类型和ID查询
  - 支持空间和标签查询

## 4. 工作流程

### 4.1 实体创建与初始化
1. 为项目模板Actor添加SyEntityComponent，并在构造函数上调用Entity初始化方法
2. 初始化添加所需功能组件(状态、交互、消息等)，并配置组件间关系和初始状态
3. 实体向SyEntityRegistry注册自身
4. 视情况关联SyStateManager（支持初始化方法配置），若不使用则独立管理状态

### 4.2 状态管理流程
1. 通过配置资产定义实体状态集（实体类型 / 状态参数），通过 TagMetadata 插件实现
2. SyStateComponent读取实体类型，并初始化自身状态参数（允许初始化配置）
3. 实体可独立修改本地状态，也可选择与StateManager同步状态
4. 状态变更触发监听器回调

### 4.3 组件间通信
待定讨论，有没有最合适的处理方式？
主要处理基于状态更新组件启用，如通过更新交互状态开关交互组件

